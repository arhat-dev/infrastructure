environments:
- name: sample
  kubeContext: sample-admin@sample

  # deployments are applied in order, so put infrastructure apps before other apps
  # may reduce errors when deploying
  deployments:
  # name is the namespaced name, format: <namespace>/<fullnameOverride>
  - name: netwok/kube-router
    # chart is the reference to a predefined chart name in `${REPO_ROOT}/.helm-stack/charts`
    chart: enix/kube-router@1.1.2

  - name: storage/local-path-provisioner
    chart: rancher/local-path-provisioner@v0.0.17

  - name: monitoring/prometheus-operator
    chart: prometheus-community/kube-prometheus-stack@10.0.1

  - name: monitoring/prometheus-adapter
    chart: prometheus-community/prometheus-adapter@2.7.0

  # metallb with ServiceMonitor enabled, so deploy prometheus operator first
  - name: network/metallb
    chart: bitnami/metallb@0.1.24

  - name: emqx/emqx
    chart: emqx/emqx@v4.2.1

  - name: storage/postgres-operator
    chart: zalando/postgres-operator@v1.5.0
    # set base values for manifest generation
    baseValues: values-crd.yaml

  # grafana requires a database, so we deploy it after postgres-operator
  - name: monitoring/grafana
    chart: grafana/grafana@5.7.9
